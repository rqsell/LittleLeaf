{"ast":null,"code":"import axios from 'axios';\nimport baseURL from './config.js';\nimport { NotificationContainer, NotificationManager } from 'react-notifications';\nconsole.log(baseURL);\nconst token = window.localStorage.getItem('token');\nlet t = token ? token.substring(0, 15) : null;\nconsole.log('TOKEN', t, 'NODE_ENV', process.env.NODE_ENV);\n\nlet resetHead = () => {\n  return {\n    headers: {\n      Authorization: `Bearer ${window.localStorage.getItem('token')}`\n    }\n  };\n};\n\nconst API = axios.create({\n  withCredentials: true,\n  baseURL,\n  headers: {\n    Authorization: `Bearer ${token}`\n  }\n});\nconst actions = {\n  getUser: async () => {\n    return await API.get(`/user`, resetHead());\n  },\n  signUp: async user => {\n    var _res$data;\n\n    let res = await API.post('/signup', user, resetHead());\n    window.localStorage.setItem('token', res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.token);\n    return res;\n  },\n  logIn: async user => {\n    var _res$data2;\n\n    let res = await API.post('/login', user, resetHead());\n    window.localStorage.setItem('token', res === null || res === void 0 ? void 0 : (_res$data2 = res.data) === null || _res$data2 === void 0 ? void 0 : _res$data2.token);\n    return res;\n  },\n  logOut: async () => {\n    window.localStorage.removeItem('token');\n    return await API.get('/logout', resetHead());\n  }\n};\nAPI.interceptors.response.use(response => response, error => {\n  var _error$response, _error$response2, _error$response3;\n\n  console.error(error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data);\n  if ((error === null || error === void 0 ? void 0 : (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data.name) !== \"JsonWebTokenError\") NotificationManager.error(String(error === null || error === void 0 ? void 0 : (_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.data.message));else NotificationManager.error(\"Please signup or login\");\n});\nexport default actions;","map":{"version":3,"sources":["/Users/rebeccasell/Documents/project4-plate/IronPlate/frontend/src/api/index.js"],"names":["axios","baseURL","NotificationContainer","NotificationManager","console","log","token","window","localStorage","getItem","t","substring","process","env","NODE_ENV","resetHead","headers","Authorization","API","create","withCredentials","actions","getUser","get","signUp","user","res","post","setItem","data","logIn","logOut","removeItem","interceptors","response","use","error","name","String","message"],"mappings":"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","sourcesContent":["import axios from 'axios';\nimport baseURL from './config.js'\nimport {NotificationContainer, NotificationManager} from 'react-notifications';\n\n\nconsole.log(baseURL)\n\nconst token = window.localStorage.getItem('token')\nlet t = token ? token.substring(0,15):null\n\nconsole.log('TOKEN',t, 'NODE_ENV',process.env.NODE_ENV)\n\n\nlet resetHead = () =>  {  \n  return { headers: { Authorization: `Bearer ${window.localStorage.getItem('token')}` } }\n}\n\nconst API = axios.create({ withCredentials: true, baseURL ,  headers: { Authorization: `Bearer ${token}`} } );\n\n\nconst actions = {\n  getUser: async () => {\n    return await API.get(`/user`, resetHead())\n  },\n  signUp: async (user) => {\n    let res = await API.post('/signup', user, resetHead())\n    window.localStorage.setItem('token', res?.data?.token)\n    return res\n  },\n  logIn: async (user) => {\n    let res = await API.post('/login', user, resetHead())\n    window.localStorage.setItem('token', res?.data?.token)\n    return res\n  },\n  logOut: async () => {\n    window.localStorage.removeItem('token')\n    return await API.get('/logout', resetHead())\n  }\n};\n\nAPI.interceptors.response.use((response) => response, (error) => { \n  console.error(error?.response?.data)\n  if(error?.response?.data.name !== \"JsonWebTokenError\" )\n    NotificationManager.error(String(error?.response?.data.message))\n  else\n    NotificationManager.error(\"Please signup or login\")\n\n})\n\nexport default actions;\n"]},"metadata":{},"sourceType":"module"}